<!DOCTYPE html>
<meta charset="utf-8">
<style>

.chart rect {
  fill: lightblue;
}

.chart text {
  fill: darkgreen;
  font: 10px sans-serif;
  text-anchor: end;
}

</style>
<input id="csv-input" type="text" value="Enter comma-separated-values to chart."></input>
<input id="chart-input" onclick="barCharter(d3.event)" type="button" value="Chart Input"></input>
<br />
<svg class="chart" tabindex="0"></svg>
<script src="d3.v4.min.js" charset="utf-8"></script>
<script>

var data = [2, 4, 8, 16, 32, 64, 128, 256, 512];

var width = 420,
    barHeight = 20;

var chart = d3.select(".chart")
    .attr("width", width)
    .attr("height", barHeight * data.length);

d3.select('#csv-input').on('keyup', function(){
    if (d3.event.key === 'Enter') {
        barCharter();
    }
});

barCharter();

function barCharter() {
/*
var bar = chart.selectAll("g")
    .data(data)
  .enter().append("g")
        .attr("transform", function(d, i) { return "translate(0," + i * barHeight + ")"; });

bar.append("rect")
    .attr("width", x)
    .attr("height", barHeight - 1);

bar.append("text")
    .attr("x", function(d) { return x(d) + 20; })
    .attr("y", barHeight / 2)
    .attr("dy", ".35em")
    .text(function(d) { return d; });

*/
    var text = d3.select('#csv-input')._groups[0][0].value; 
    if (text !== "Enter comma-separated-values to chart.") {
        data = JSON.parse('[' + text + ']');
    }

    var x = d3.scaleLinear()
        .domain([0, d3.max(data)])
        .range([0, width - 20]);

    console.log(data);

    var bar = chart.selectAll('g')
        .data(data)
      .enter()
        .append('g')
        .attr('transform', function(d, i) {return "translate(0," + i * barHeight + ")"; });
      // WHERE DOES THIS GO????? .merge(text)
      // THIS WAS FROM BOSTOCK's GENERAL UPDATE PATTERN

    bar.append("rect")
        .attr("width", x)
        .attr("height", barHeight - 1);

    bar.append("text")
        .attr("x", function(d) { return x(d) + 20; })
        .attr("y", barHeight / 2)
        .attr("dy", ".35em")
        .text(function(d) { return d; });

    bar.exit().remove();
}

function scatterPlotter() {
    var data = [{val:0.0}, {val:0.1961619029653322}, {val:1.5201954638873865}, {val:0.5799944033175563}, {val:0.09782659213685685}, {val:1.4062192585005528}, {val:4.979929631640961}, {val:0.7773185009207358}, {val:2.409773525046554}, {val:5.918816234885444}, {val:3.850612047394877}, {val:5.2148185343293365}, {val:10.869381731524706}, {val:7.498428733653223}, {val:0.6085109006390197}, {val:10.844743190101836}, {val:11.393835273430469}, {val:5.074292931982589}, {val:11.469298194088205}, {val:15.764997367154365}, {val:10.962446403294141}, {val:7.993525873548178}, {val:5.766559191731902}, {val:9.00421433675468}, {val:23.677105768110543}, {val:14.529423583077024}, {val:24.174205025848888}, {val:4.577321286755351}, {val:21.87031011284762}, {val:23.694553038577297}, {val:21.87005213720041}, {val:27.670077762839778}],
        width = 420,
        height = 420,
        r = 5;

    var svg = d3.select('svg')
        .attr('width', width)
        .attr('height', height);
    //svg.selectAll('g').remove();

    var scatter = svg.selectAll('g')
      .bind(data);

    svg.enter().append('g')
        .attr("x", function(d, i) { return i * 5; })
        .style("fill", "purple");

    console.log(svg);
}

</script>
